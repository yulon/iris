<html>

<head>
<meta charset="utf-8">
<style>
	body {
		background-color: #E5E5E5;
		text-align: center;
		font-family: "Segoe UI","Lucida Grande",Helvetica,Arial,"Microsoft YaHei",FreeSans,Arimo,"Droid Sans","wenquanyi micro hei","Hiragino Sans GB","Hiragino Sans GB W3",sans-serif;
	}
	#canvas {
		background-color: #000000;
		box-shadow: 0px 5px 50px rgba(0, 0, 0, 0.8);
	}

</style>

</head>

<body>
	<canvas id="canvas" width="700" height="600"></canvas>

	<script type="text/plain" id="vSource">
		attribute vec3 position;
		uniform mat4 mMatrix;
		uniform mat4 pMatrix;
		varying vec3 vPosition;
		void main(){
			gl_Position=pMatrix*mMatrix*vec4(position,1.0);
			vPosition=position;
		}
	</script>
	<script type="text/plain" id="fSource">
		precision lowp float;
		varying vec3 vPosition;
		uniform sampler2D texture;
		void main(){
			gl_FragColor=texture2D(texture, vec2(vPosition.x*0.5+0.5,0.5-vPosition.y));
		}
	</script>

	<script src="SimpleWebGL.2.0.js"></script>
	<script src="SimpleWebGL.Matrix.1.0.js"></script>
	<script>
		//var canvas = document.getElementById("cav");
		//使用SimpleWebGL
		new SimpleWebGL(canvas).namespace(function(){
			eval(this.EXTRACT);
			/*贴图数据*/
			//创建Canvas，并设置大小
			var text = document.createElement("canvas");
			text.width = 512;
			text.height = 256;
			//对其绘制文字
			var textcxt = text.getContext("2d");

				//设置文字属性
			textcxt.textBaseline="middle";
			textcxt.textAlign="center";
			textcxt.font = "Bold 30px 'Segoe UI' 'Lucida Grande' Helvetica Arial 'Microsoft YaHei' FreeSans Arimo 'Droid Sans' 'wenquanyi micro hei' 'Hiragino Sans GB' 'Hiragino Sans GB W3' sans-serif";
			textcxt.fillStyle="#FFFFFF"
			textcxt.fillText("咿呀咿呀哟", 256, 128);

			//放入Texture2D对象
			new Texture2D(text,"RGBA").bind(1);
			/*顶点数据*/
			//做出一个点阵型的长方体，用来往上面贴图
			var position=[];
			(function(){
				var i,j,w=1<<7,h=1<<6,k=900;
				for(i=-w;i<=w;i++)for(j=-h;j<=h;j++)
					position.push(i/k, j/k, 0.01, i/k, j/k, -0.01);
			})();
			/*创建着色程序*/
			var program=new Program(
				new VertexShader(vSource),new FragmentShader(fSource)
			).link().use().data({
				pMatrix: Matrix.projection(45,canvas.width/canvas.height,0.1,100),
				position: new ArrayBuffer(position),
				texture: 1
			});
			/*设置绘制属性并绘制*/
			this.setting("BLEND",["SRC_ALPHA","ONE"]).play(function(time){
				this.clear("COLOR");
				//使用线条作为图元来绘制所有顶点
				program.data({
					mMatrix:Matrix.model([0, 0, -1], time/2-45) //处理模型矩阵
				}).draw(position.length/3, "LINES"); //调用绘制
			});
		});

	</script>
</body>

</html>